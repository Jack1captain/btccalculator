<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>BTC æ­¢ç›ˆ & æ æ†è‡ªåŠ¨è®¡ç®—å·¥å…·</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #0d1117;
        color: #e6edf3;
        padding: 20px;
    }
    h2 {
        text-align: center;
        color: #58a6ff;
    }
    .container {
        max-width: 520px;
        margin: auto;
        background: #161b22;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }
    label {
        display: block;
        margin-top: 15px;
        font-size: 15px;
    }
    input, select {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: none;
        margin-top: 5px;
        font-size: 15px;
    }
    button {
        width: 100%;
        margin-top: 20px;
        background: #238636;
        color: white;
        padding: 12px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
    }
    button:hover {
        background: #2ea043;
    }
    .result {
        margin-top: 20px;
        padding: 15px;
        background: #21262d;
        border-radius: 10px;
        font-size: 15px;
        line-height: 1.6;
    }
    .highlight {
        color: #58a6ff;
        font-weight: bold;
    }
</style>
</head>
<body>

<h2>BTC æ­¢ç›ˆ & æ æ†è‡ªåŠ¨è®¡ç®—å™¨ï¼ˆå« OKX æ‰‹ç»­è´¹ï¼‰</h2>

<div class="container">
    <label>æŠ•å…¥èµ„é‡‘ (USDT)</label>
    <input type="number" id="funds" placeholder="ä¾‹å¦‚ï¼š500">

    <label>å¼€ä»“ä»·</label>
    <input type="number" id="entry" placeholder="ä¾‹å¦‚ï¼š98700">

    <label>æ­¢æŸä»·</label>
    <input type="number" id="stop" placeholder="ä¾‹å¦‚ï¼š95500">

    <label>æ–¹å‘</label>
    <select id="direction">
        <option value="long">åšå¤š</option>
        <option value="short">åšç©º</option>
    </select>

    <button onclick="calculate()">å¼€å§‹è®¡ç®—</button>

    <div id="output" class="result" style="display:none;"></div>
</div>

<script>
function calculate() {
    const funds = parseFloat(document.getElementById("funds").value);
    const entry = parseFloat(document.getElementById("entry").value);
    const stop = parseFloat(document.getElementById("stop").value);
    const direction = document.getElementById("direction").value;

    if (!funds || !entry || !stop) {
        alert("è¯·å¡«å†™æ‰€æœ‰è¾“å…¥é¡¹ï¼");
        return;
    }

    // ===== å‚æ•°è®¾å®š =====
    const maxLossPercent = 0.05;           // æœ€å¤§äºæŸ 5%
    const feeRate = 0.001;                 // OKX BTC åˆçº¦ åŒè¾¹æ‰‹ç»­è´¹ 0.1%

    let R, tp;

    if (direction === "long") {
        R = entry - stop;
        tp = entry + 1.5 * R;
    } else {
        R = stop - entry;
        tp = entry - 1.5 * R;
    }

    const priceRiskPercent = Math.abs((entry - stop) / entry);

    // å¯æ‰¿å—æœ€å¤§äºæŸé‡‘é¢
    const maxLoss = funds * maxLossPercent;

    /*
        æ€»é£é™© = ä»·æ ¼äºæŸ + æ‰‹ç»­è´¹
        = ä»“ä½è§„æ¨¡ Ã— (ä»·æ ¼æ³¢åŠ¨æ¯”ä¾‹ + æ‰‹ç»­è´¹ç‡)
        = funds Ã— leverage Ã— (priceRiskPercent + feeRate)
    */
    let leverage = maxLoss / (funds * (priceRiskPercent + feeRate));
    leverage = Math.min(100, leverage);
    leverage = leverage.toFixed(2);

    const positionSize = funds * leverage;
    const feeCost = positionSize * feeRate;

    document.getElementById("output").style.display = "block";
    document.getElementById("output").innerHTML = `
        ğŸ“Œ <span class="highlight">è®¡ç®—ç»“æœ</span><br><br>

        ğŸ”¸ 1.5R å»ºè®®æ­¢ç›ˆä»·ï¼š<span class="highlight">${tp.toFixed(2)}</span><br>
        ğŸ”¸ æ¨èæ æ†å€æ•°ï¼š<span class="highlight">${leverage}x</span><br><br>

        ğŸ“‰ æœ€å¤§å…è®¸äºæŸï¼ˆæœ¬é‡‘ 5%ï¼‰ï¼š<span class="highlight">${maxLoss.toFixed(2)} USDT</span><br>
        ğŸ’¸ é¢„ä¼° OKX æ‰‹ç»­è´¹ï¼ˆå¼€+å¹³ï¼‰ï¼š<span class="highlight">${feeCost.toFixed(2)} USDT</span><br>
        ğŸ“Š ä»·æ ¼æ­¢æŸæ³¢åŠ¨æ¯”ä¾‹ï¼š<span class="highlight">${(priceRiskPercent * 100).toFixed(3)}%</span><br>
    `;
}
</script>

</body>
</html>
